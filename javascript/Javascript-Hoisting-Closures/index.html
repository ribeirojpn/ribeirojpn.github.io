<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Variáveis, Hoisting, Closures e IIFE em Javascript · RibeiroJPN</title><meta name="description" content="Variáveis, Hoisting, Closures e IIFE em Javascript - Joao Paulo Ribeiro"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><h1 class="nav-title">RibeiroJPN</h1></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/ribeirojpn" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://twitter.com/ribeirojpn" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Variáveis, Hoisting, Closures e IIFE em Javascript</h1><div class="post-info">Nov 15, 2015</div><div class="post-content"><p>Nesse artigo irei abordar rapidamente alguns conceitos básicos mas essenciais da linguagem Javascript. Vou apresentar 5 conceitos muito importantes sobre como criar e instanciar variáveis e funções, são eles: Hoisting, Closure, Variável Global, Variável por parâmetro e IIFE.</p>
<h2 id="Hoisting"><a href="#Hoisting" class="headerlink" title="Hoisting"></a>Hoisting</h2><p>O Javascript possui o comportamento de mover a declaração de uma variável ou função para o topo do escopo, o que significa que você pode usar uma função ou variável antes dela ter sido declarada. O que acontece é que as declarações de variáveis e funções são processadas antes que qualquer outro código seja executado, transformando este código:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">run();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Run, Forrest, run!"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// vai imprimir -&gt; Run, Forrest, run!</span></div></pre></td></tr></table></figure>
<p>neste:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Run, Forrest, run!"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">run(); <span class="comment">// imprime 'Run, Forrest, run!'</span></div></pre></td></tr></table></figure>
<p>Isto possibilita que você utilize funções dentro de outras funções mantendo uma organização que mais lhe agrade. Um exemplo que costumo fazer é colocar o <code>sets</code> e <code>gets</code> sempre como as ultimas funções no arquivo (me acostumei a fazer assim programando em <code>Java</code> ^^ ):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> carro = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">meuCarro</span>(<span class="params">marca, portas</span>) </span>&#123;</div><div class="line">  setMarca(marca);</div><div class="line">  setNumeroDePortas(portas);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setMarca</span>(<span class="params">nomeDaMarca</span>) </span>&#123;</div><div class="line">  carro.marca = nomeDaMarca;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setNumeroDePortas</span>(<span class="params">numeroDePortas</span>) </span>&#123;</div><div class="line">  carro.portas = numeroDePortas;</div><div class="line">&#125;</div><div class="line"></div><div class="line">meuCarro(<span class="string">"fiat"</span>, <span class="number">4</span>);</div><div class="line"><span class="built_in">console</span>.log(carro.marca); <span class="comment">// imprime 'fiat'</span></div></pre></td></tr></table></figure>
<p>No caso de variáveis, se você inicializar a mesma após ter sido utilizada, o hoisting acontecerá porem a variável terá valor <code>undefined</code> pois no momento da execução a variável já foi declarada, mas ainda não foi inicializada.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(vader); <span class="comment">// imprime 'undefined'</span></div><div class="line">vader = <span class="string">"I am your father"</span></div><div class="line"><span class="keyword">var</span> vader;</div></pre></td></tr></table></figure>
<p>esse código se transforma neste:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vader; <span class="comment">// variavel declarada mas não inicializada</span></div><div class="line"><span class="built_in">console</span>.log(vader); <span class="comment">// imprime 'undefined'</span></div><div class="line">vader = <span class="string">"I am your father"</span> <span class="comment">// inicialização da variável após ter sido usada no log.</span></div></pre></td></tr></table></figure>
<h2 id="Closures"><a href="#Closures" class="headerlink" title="Closures"></a>Closures</h2><p>Closures são funções dentro de outras funções que possuem acesso a variaveis da função a qual está inserido. Elas possuem três escopos acessiveis: o proprio escopo, escopo da função em que está inserido e o escopo global. Isto significa que, alem de ter acesso as variaveis declaradas nestes escopos, os Closures tambem possuem acesso aos argumentos passados na função a qual está inserido. Um exemplo pra ficar mais fácil de compreender:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> carro = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">meuCarro</span>(<span class="params">nomeDaMarca, numeroDePortas</span>) </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setMarca</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    carro.marca = nomeDaMarca;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setNumeroDePortas</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    carro.portas = numeroDePortas;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mostrarCarro</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Carro da "</span> + nomeDaMarca + <span class="string">" de "</span> + numeroDePortas + <span class="string">" portas."</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  setMarca();</div><div class="line">  setNumeroDePortas();</div><div class="line">  mostrarCarro();</div><div class="line">&#125;</div><div class="line">meuCarro(<span class="string">"fiat"</span>,<span class="number">2</span>); <span class="comment">// imprime 'Carro da fiat de 2 portas.'</span></div></pre></td></tr></table></figure>
<p>Como Javascript não oferece formas de declarar metodos privados como outras linguagens como Java(utilizando <code>private</code> na declaração de um metodo), você pode utilizar closures para emular metodos privados. Veja um exemplo utilizando, mais uma vez, o exemplo do ‘meuCarro’:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> meuCarro = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> carro = &#123; velocidade: <span class="number">0</span> &#125;;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">vel</span>(<span class="params">valor</span>)</span>&#123;</div><div class="line">    carro.velocidade += valor;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    acelerar: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      vel(<span class="number">10</span>);</div><div class="line">    &#125;,</div><div class="line">    reduzir: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      vel(<span class="number">-10</span>);</div><div class="line">    &#125;,</div><div class="line">    velocidadeAtual: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> carro.velocidade;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;)();</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(meuCarro.velocidadeAtual()); <span class="comment">// imprime '0'</span></div><div class="line">meuCarro.acelerar();</div><div class="line"><span class="built_in">console</span>.log(meuCarro.velocidadeAtual()); <span class="comment">// imprime '10'</span></div><div class="line">meuCarro.acelerar();</div><div class="line">meuCarro.acelerar();</div><div class="line"><span class="built_in">console</span>.log(meuCarro.velocidadeAtual()); <span class="comment">// imprime '30'</span></div><div class="line">meuCarro.reduzir();</div><div class="line"><span class="built_in">console</span>.log(meuCarro.velocidadeAtual()); <span class="comment">// imprime '20'</span></div><div class="line">meuCarro.vel(<span class="number">40</span>); <span class="comment">// 'TypeError: meuCarro.vel is not a function'</span></div><div class="line"><span class="built_in">console</span>.log(meuCarro.velocidadeAtual()); <span class="comment">// imprime '20'</span></div></pre></td></tr></table></figure>
<p>O método <code>vel(valor)</code> só pode ser utilizado dentro do escopo de <code>meuCarro</code> tornando assim um método privado.</p>
<h2 id="Variavel-Global"><a href="#Variavel-Global" class="headerlink" title="Variável Global"></a>Variável Global</h2><p>Variáveis Globais são variáveis que são declaradas fora de uma função. Essas variáveis podem ser acessadas e alteradas dentro de qualquer função, ficando disponível para todo o documento.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vader = <span class="string">"I am your father"</span> <span class="comment">// variavel global</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  vader = str;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">speak</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(vader);</div><div class="line">&#125;</div><div class="line"></div><div class="line">speak(); <span class="comment">// imprie 'I am your father'</span></div><div class="line">change(<span class="string">"Come to the dark side"</span>);</div><div class="line">speak(); <span class="comment">// imprime 'Come to the dark side'</span></div></pre></td></tr></table></figure>
<p>Quando iniciamos uma variável dentro de uma função sem declará-la, essa variável se torna uma Variável Global.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  vader = str;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">speak</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(vader);</div><div class="line">&#125;</div><div class="line"></div><div class="line">speak(); <span class="comment">// 'ReferenceError: vader is not defined'</span></div><div class="line">change(<span class="string">"Come to the dark side"</span>);</div><div class="line">speak(); <span class="comment">// imprime 'Come to the dark side'</span></div></pre></td></tr></table></figure>
<p>A ultima chamada da função <code>speak()</code> imprime ‘Come to the dark side’ porque a variável <code>vader</code> inicializada em <code>change(str)</code> se torna global por passar pelo processo de <a href="#hoisting">Hoisting</a>.</p>
<h2 id="Variavel-por-Parametro"><a href="#Variavel-por-Parametro" class="headerlink" title="Variável por Parâmetro"></a>Variável por Parâmetro</h2><p>Parâmetros são valores passados como recurso para uma função, são atribuídos a variáveis locais no escopo da função. Quando uma variável global é passada como parâmetro, apenas o valor da variável é recebida pela função.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">  num = <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> num;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(change(x)); <span class="comment">// imprime 2 retornado pelo função change(x)</span></div><div class="line"><span class="built_in">console</span>.log(x)/ <span class="comment">// imprime 10, valor de x no escopo global</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeX</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  x = <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(change(x)); <span class="comment">// passando variavel global como parametro, imprime 2 retornado pela função change(x)</span></div><div class="line"><span class="built_in">console</span>.log(x)/ <span class="comment">// imprime 10, valor de x no escopo global</span></div></pre></td></tr></table></figure>
<p>Quando você passa uma Variável Global como parâmetro de uma função o seu valor é atribuído a uma variável local. No segundo exemplo é criada uma variável “x” no escopo local que recebe o valor da variável global “x”, quando altero o valor de x dentro de <code>change(x)</code> estou alterando apenas o valor da variável local. Para alterar a variável global preciso que não seja criada uma variável com mesmo nome dentro do escopo local:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> newValue = <span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">  x = num;</div><div class="line">  <span class="keyword">return</span> x;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">change(newValue); <span class="comment">// retorna 5</span></div><div class="line"><span class="built_in">console</span>.log(x)/ <span class="comment">// imprime 5, novo valor de x no escopo global</span></div></pre></td></tr></table></figure>
<h2 id="Instanciacao-usando-uma-IIFE"><a href="#Instanciacao-usando-uma-IIFE" class="headerlink" title="Instanciação usando uma IIFE"></a>Instanciação usando uma IIFE</h2><p>IIFE é uma sigla para “Immediately-Invoked Function Expression” que em português<br>pode ser chamado de “Definição de Função Imediatamente Executável”. São funções que são executadas no mesmo momento em que são definidas. Utilizar IIFE pode ser muito útil quando não queremos que códigos javascript de outras pessoas acessem ou alterem as variáveis que definimos.</p>
<p>Exemplo:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> vader = str;</div><div class="line">  <span class="built_in">console</span>.log(vader);</div><div class="line">&#125;(<span class="string">'I need a friend...'</span>)); <span class="comment">// imprime 'I need a friend...'</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(vader); <span class="comment">// ReferenceError: vader is not defined</span></div></pre></td></tr></table></figure></p>
<p>Uma IIFE é declarada inserindo uma função, variável ou operação dentro de parenteses como parâmetros para uma função, que automaticamente retornara o que está entre os parenteses.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;) <span class="comment">// retorna a function() dentro dos parenteses</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;)() <span class="comment">// executa a function() dentro dos parenteses</span></div><div class="line">(<span class="number">4</span>*<span class="number">5</span>) <span class="comment">// retorna 20</span></div><div class="line">(<span class="literal">true</span>) <span class="comment">// retorna true</span></div></pre></td></tr></table></figure>
<p>Em um dos exemplos de <a href="#closures">Closures</a> utilizei uma IIFE para atribuir uma função autoexecutável a uma variável.</p>
</div><div class="tags"><a href="/tags/javascript/">javascript</a><a href="/tags/learn/">learn</a></div></article></div></section><footer><div class="paginator"><a href="/java/json-web-token-play/" class="prev">PREV</a><a href="/javascript/estudando-javascript/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ribeirojpn';
var disqus_identifier = 'javascript/Javascript-Hoisting-Closures/';
var disqus_title = 'Variáveis, Hoisting, Closures e IIFE em Javascript';
var disqus_url = 'http://ribeirojpn.github.io/javascript/Javascript-Hoisting-Closures/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ribeirojpn.disqus.com/count.js" async></script><div class="copyright"><p>© 2016 <a href="http://ribeirojpn.github.io">Joao Paulo Ribeiro</a>. Powered by <a href="https://hexo.io/">Hexo</a>. Theme by <a href="https://github.com/pinggod/hexo-theme-apollo">pinggod</a> and customized by <a href="https://github.com/ribeirojpn/hexo-theme-apollo">RibeiroJPN</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-80318173-1",'auto');ga('send','pageview');</script></body></html>